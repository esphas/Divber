#!/usr/bin/env ruby
STDOUT.sync = true

require 'divber'
require 'rayormoche'

Rayormoche.apply :divber do |divber|
  # new
  divber.command :new do |cmd|
    cmd.alias :n
    cmd.alias :init
    cmd.alias :i
    cmd.description = 'initialize site in specific path or current directory by default'
    cmd.syntax = '<command> [SOURCE]'
    cmd.action do |opts, args|
      Divber.command :new, opts, args
    end
  end
  # build
  divber.command :build do |cmd|
    cmd.alias :b
    cmd.description = 'build site in specific path or current directory by default'
    cmd.syntax = '<command> [SOURCE] [options]'
    cmd.option :dest, '-d DEST', '--dest', 'specify the dest path of the site to be generated'
    cmd.action do |opts, args|
      Divber.command :build, opts, args
    end
  end
  # invalid command
  divber.action do |_, args|
    abort ['Divber: Invalid command: ', args].flatten.join.warningfy
  end
end
